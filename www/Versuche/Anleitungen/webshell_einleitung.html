<h2 id="allgemeines-angriff">Allgemeines / Angriff</h2>
<h3 id="webshell">Webshell</h3>
<p>Webshells sind Skripte die, wenn sie auf einen Webserver
eingeschleust werden, einen Fernzugriff (Backdoor) f√ºr einen/eine
Angreifer/-in darstellen. Eine Webshell kann in jeder Programmiersprache
(z.B. ASP, PHP, JSP, Python, Ruby, C++, usw.) geschrieben sein, der
Zielserver sollte jedoch die Sprache unterst√ºtzen, damit die Webshell
ausgef√ºhrt werden kann. Webshells k√∂nnen in verschiedenen Formen
auftreten, eine beliebte Form ist z.B. eine Datei mit nur einer beliebig
Langen Zeile, die dazu noch bspw. base64 codiert ist. Diese Art von
Formatierung verschleiert den Code und erschwert dem/der Leser/-in der
Datei den Code zu verstehen und als Webshell zu enttarnen.</p>
<p>Die Webshell dient in den meisten F√§llen als Einstiegspunkt um
Befehle auszuf√ºhren und um die damit verbundenen M√∂glichkeiten
auszunutzen, wie etwa die Privilegien-Eskalation (Zugriff verschaffen
auf Ressourcen die normalerweise erweiterte Berechtigungen erfordern),
weitere Dateien hochzuladen, sensible Daten zu stehlen, Create, Read,
Update und Delete-Operatoren durchzuf√ºhren oder auch um Programme
auszuf√ºhren.</p>
<p>Durch den Einsatz von Netzwerkwerkzeugen k√∂nnen Angreifer/-innen
Schwachstellen innerhalb eines Webservers finden und diese
Sicherheitsl√ºcken gezielt auszunutzen, um ihre Webshell auf den
Webserver zu transferieren. Sicherheitsl√ºcken wie das Einbinden von
nicht validierten Codes in die Webanwendung (Cross-Site-Scripting) oder
durch eine nicht validierte Dateiupload Funktion, wie es in dieser √úbung
der Fall, ist k√∂nnen dazu genutzt werden, um die Webshell zu
platzieren.</p>
<h3 id="webshell-skript"><strong>Webshell</strong>
<strong>(Skript)</strong></h3>
<p>Eine base64 und in eine Zeile formatierte PHP-Datei. Enth√§lt den Code
um den Angriff f√ºr diese √úbung durchzuf√ºhren.</p>
<h3 id="allgemeine-programme">Allgemeine Programme</h3>
<ul>
<li><p><strong>OpenSSH-Server</strong></p>
<p>SSH (Secure Shell) ist ein Internetprotokoll und dient dem sicheren
Zugriff auf entfernte Rechner. √úber SSH kann eine Terminalsitzung
ge√∂ffnet werden, aber auch Daten sicher kopiert werden.</p>
<p>OpenSSH ist ein Programmpaket f√ºr die Remoteanmeldung via
SSH-Protokoll</p>
<p>Je nach Konfiguration k√∂nnen verschieden
Authentifizierungsm√∂glichkeiten verwendet werden, u.a. die
Zwei-Faktor-Authentisierung oder dem Public-Private-Key
Verfahren.</p></li>
<li><p><strong>Nano</strong></p>
<p>Ein Texteditor, welches die Bearbeitung von Dateien im Terminal
erm√∂glicht</p></li>
</ul>
<h3 id="angreifer-in">Angreifer/-in</h3>
<ul>
<li><p><strong>w3af</strong></p>
<p>Open-Source-Sicherheitsscanner f√ºr Webanwendungen. Erm√∂glicht mittels
Plug-Ins das Scannen einer Webanwendung mit verschiedenen
Modulen.</p></li>
<li><p><strong>Kali Linux</strong></p>
<p>Eine auf Debian basierte Linux Distribution. Kali Linux stellt
Programme f√ºr Penetrationstest zur Verf√ºgung. Die auf dieser
Distribution installierten Programme unterst√ºtzen den/die Angreifer/-in,
in dieser √úbung bei dem Webshell-Angriff.</p>
<ul>
<li><p><strong>Netcat</strong></p>
<p>Netcat, kurz nc, ist ein universelles Kommandozeilenwerkzeug. Es kann
im Terminal oder in Skripten f√ºr die Kommunikation √ºber TCP- und
UDP-Netzwerkverbindungen (IPv4 und 6), aber auch lokale UNIX Domain
Sockets genutzt werden.</p></li>
<li><p><strong>John The Ripper</strong></p>
<p>Ist eine Software um Passw√∂rter zu entschl√ºsseln.</p>
<p>ssh2john.py [<strong>Schl√ºssedatei</strong>] &gt;
[<strong>Zieldatei</strong>] wird in dieser √úbung genutzt um die
Passphrase f√ºr einen privaten Schl√ºssel herauszufinden.</p></li>
<li><p><strong>Wordlist</strong></p>
<p>Zu dt. Passw√∂rterliste ist eine Liste an W√∂rtern, die meist in
Verbindung mit dem W√∂rterbuchangriff genutzt werden, um Passw√∂rter zu
knacken. Die hier verwendete W√∂rterliste ist rockyou.txt.</p></li>
</ul></li>
</ul>
<h3 id="server-seite">Server Seite</h3>
<ul>
<li><p><strong>Webserver</strong></p>
<p>Ziel des Webshell-Angriffs.</p>
<p>Stellt einen Mock-up eines <strong>Messenger</strong> zur
Verf√ºgung.</p>
<p>Der Server enth√§lt mehrere Benutzer/-innen und eine
Datenbankschnittstelle.</p>
<p>Der Server persistiert die hochgeladenen Dateien.</p>
<p>Das Layout des Dateisystems sieht folgenderma√üen aus:</p>
<ul>
<li><p>/<strong>var/www/html</strong>:</p>
<p>Hier liegen die Verzeichnisse und Dateien um die Webapplikation
darzustellen</p></li>
<li><p><strong>/etc</strong>:</p>
<p>Enth√§lt Konfigurationsdateien, z.B. die Dateien
<strong>passwd</strong> (Informationen √ºber alle Benutzerkonten) und
<strong>shadow</strong> (enth√§lt die verschl√ºsselten Passw√∂rter der
Benutzer bzw. Benutzerinnen)</p></li>
<li><p><strong>/home</strong>:</p>
<p>Enth√§lt Homeverzeichnisse. Das Homeverzeichnis f√ºr den root Benutzer
bzw. Benutzerin ist unter /root zu finden.</p></li>
</ul></li>
<li><p><strong>Webapplikation</strong></p>
<p>Eine statische Webseite, ohne Caching. Ein neu laden der Seite setzt
alle an der Webapplikation vorgenommen √Ñnderungen zur√ºck (geschriebene
Nachrichten werden nicht persistiert).</p>
<p>Beinhaltet eine Dateiupload-Funktion.</p>
<p>Der erste angezeigte Chat beinhaltet ein bereits auf den Server
hochgeladenes Bild.</p></li>
<li><p><strong>Datenbank</strong></p>
<p>Eine MySQL-Datenbank. Enth√§lt Daten √ºber die
Nachrichtenapplikation.</p></li>
</ul>
<h2 id="aufbau-der-√ºbung">Aufbau der √úbung</h2>
<p>In dieser √úbung werden Sie verschiedene Perspektiven einnehmen. Die
‚Äúnormalen‚Äù Nutzer/-innen (Einf√ºhrung), die die Webanwendung als
Nachrichtenapplikation nutzen. Die Angreifer/-innen Perspektive
(Webshell-Angriff), die einen Angriff auf den Webserver durchf√ºhren und
schlussendlich die Perspektive eines/r Serveradministrator/-in, welche
die Sicherheitsl√ºcke behebt.</p>
<h2 id="wie-starten-sie-die-√ºbung">Wie starten Sie die √úbung?</h2>
<p>In dem Projektordner, welchen Sie heruntergeladen haben, finden Sie
eine <em>STARTER.sh</em> Datei, welche f√ºr Sie den Befehl
<em>docker-compose up -d</em> ausf√ºhrt. Dies startet die
Container-Landschaft, in welcher Sie den Versuch durchf√ºhren werden.
Dies kann etwas Zeit in Anspruch nehmen.</p>
<h3 id="einf√ºhrung">Einf√ºhrung</h3>
<p>√ñffnen Sie die Webseite ‚Äúlocalhost:8080‚Äù in einem Browser Ihrer Wahl,
in dem Sie die genannte URL in die Suchleiste eingeben. Machen Sie sich
mit der Webseite und deren Funktionen vertraut.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">üí°</span> Mit Hilfe der Netzwerkanalyse aus den eingebauten Entwicklerwerkzeugen des Browsers k√∂nnen HTTP Anfragen und Antworten der Webseite verfolgt werden.</span></code></pre></div>
<p>üë§ <strong>(Perspektive: Anwender/-in)</strong></p>
<p>Laden Sie vorerst einmal eine normale Bilddatei hoch, in dem Sie
unten links in der Chatleiste auf die B√ºroklammer klicken. Es erscheint
ein grauer Screen. Dr√ºcken Sie erneut auf die B√ºroklammer um ein Bild
auszuw√§hlen. Mit einem Klick auf den Papierflieger l√§sst sich das Bild
hochladen.</p>
<h2 id="allgemeines-angriff-1">Allgemeines / Angriff</h2>
<h3 id="webshell-1">Webshell</h3>
<p>Webshells sind Skripte die, wenn sie auf einen Webserver
eingeschleust werden, einen Fernzugriff (Backdoor) f√ºr einen/eine
Angreifer/-in darstellen. Eine Webshell kann in jeder Programmiersprache
(z.B. ASP, PHP, JSP, Python, Ruby, C++, usw.) geschrieben sein, der
Zielserver sollte jedoch die Sprache unterst√ºtzen, damit die Webshell
ausgef√ºhrt werden kann. Webshells k√∂nnen in verschiedenen Formen
auftreten, eine beliebte Form ist z.B. eine Datei mit nur einer beliebig
Langen Zeile, die dazu noch bspw. base64 codiert ist. Diese Art von
Formatierung verschleiert den Code und erschwert dem/der Leser/-in der
Datei den Code zu verstehen und als Webshell zu enttarnen.</p>
<p>Die Webshell dient in den meisten F√§llen als Einstiegspunkt um
Befehle auszuf√ºhren und um die damit verbundenen M√∂glichkeiten
auszunutzen, wie etwa die Privilegien-Eskalation (Zugriff verschaffen
auf Ressourcen die normalerweise erweiterte Berechtigungen erfordern),
weitere Dateien hochzuladen, sensible Daten zu stehlen, Create, Read,
Update und Delete-Operatoren durchzuf√ºhren oder auch um Programme
auszuf√ºhren.</p>
<p>Durch den Einsatz von Netzwerkwerkzeugen k√∂nnen Angreifer/-innen
Schwachstellen innerhalb eines Webservers finden und diese
Sicherheitsl√ºcken gezielt auszunutzen, um ihre Webshell auf den
Webserver zu transferieren. Sicherheitsl√ºcken wie das Einbinden von
nicht validierten Codes in die Webanwendung (Cross-Site-Scripting) oder
durch eine nicht validierte Dateiupload Funktion, wie es in dieser √úbung
der Fall, ist k√∂nnen dazu genutzt werden, um die Webshell zu
platzieren.</p>
<h3 id="webshell-skript-1"><strong>Webshell</strong>
<strong>(Skript)</strong></h3>
<p>Eine base64 und in eine Zeile formatierte PHP-Datei. Enth√§lt den Code
um den Angriff f√ºr diese √úbung durchzuf√ºhren.</p>
<h3 id="allgemeine-programme-1">Allgemeine Programme</h3>
<ul>
<li><p><strong>OpenSSH-Server</strong></p>
<p>SSH (Secure Shell) ist ein Internetprotokoll und dient dem sicheren
Zugriff auf entfernte Rechner. √úber SSH kann eine Terminalsitzung
ge√∂ffnet werden, aber auch Daten sicher kopiert werden.</p>
<p>OpenSSH ist ein Programmpaket f√ºr die Remoteanmeldung via
SSH-Protokoll</p>
<p>Je nach Konfiguration k√∂nnen verschieden
Authentifizierungsm√∂glichkeiten verwendet werden, u.a. die
Zwei-Faktor-Authentisierung oder dem Public-Private-Key
Verfahren.</p></li>
<li><p><strong>Nano</strong></p>
<p>Ein Texteditor, welches die Bearbeitung von Dateien im Terminal
erm√∂glicht</p></li>
</ul>
<h3 id="angreifer-in-1">Angreifer/-in</h3>
<ul>
<li><p><strong>w3af</strong></p>
<p>Open-Source-Sicherheitsscanner f√ºr Webanwendungen. Erm√∂glicht mittels
Plug-Ins das Scannen einer Webanwendung mit verschiedenen
Modulen.</p></li>
<li><p><strong>Kali Linux</strong></p>
<p>Eine auf Debian basierte Linux Distribution. Kali Linux stellt
Programme f√ºr Penetrationstest zur Verf√ºgung. Die auf dieser
Distribution installierten Programme unterst√ºtzen den/die Angreifer/-in,
in dieser √úbung bei dem Webshell-Angriff.</p>
<ul>
<li><p><strong>Netcat</strong></p>
<p>Netcat, kurz nc, ist ein universelles Kommandozeilenwerkzeug. Es kann
im Terminal oder in Skripten f√ºr die Kommunikation √ºber TCP- und
UDP-Netzwerkverbindungen (IPv4 und 6), aber auch lokale UNIX Domain
Sockets genutzt werden.</p></li>
<li><p><strong>John The Ripper</strong></p>
<p>Ist eine Software um Passw√∂rter zu entschl√ºsseln.</p>
<p>ssh2john.py [<strong>Schl√ºssedatei</strong>] &gt;
[<strong>Zieldatei</strong>] wird in dieser √úbung genutzt um die
Passphrase f√ºr einen privaten Schl√ºssel herauszufinden.</p></li>
<li><p><strong>Wordlist</strong></p>
<p>Zu dt. Passw√∂rterliste ist eine Liste an W√∂rtern, die meist in
Verbindung mit dem W√∂rterbuchangriff genutzt werden, um Passw√∂rter zu
knacken. Die hier verwendete W√∂rterliste ist rockyou.txt.</p></li>
</ul></li>
</ul>
<h3 id="server-seite-1">Server Seite</h3>
<ul>
<li><p><strong>Webserver</strong></p>
<p>Ziel des Webshell-Angriffs.</p>
<p>Stellt einen Mock-up eines <strong>Messenger</strong> zur
Verf√ºgung.</p>
<p>Der Server enth√§lt mehrere Benutzer/-innen und eine
Datenbankschnittstelle.</p>
<p>Der Server persistiert die hochgeladenen Dateien.</p>
<p>Das Layout des Dateisystems sieht folgenderma√üen aus:</p>
<ul>
<li><p>/<strong>var/www/html</strong>:</p>
<p>Hier liegen die Verzeichnisse und Dateien um die Webapplikation
darzustellen</p></li>
<li><p><strong>/etc</strong>:</p>
<p>Enth√§lt Konfigurationsdateien, z.B. die Dateien
<strong>passwd</strong> (Informationen √ºber alle Benutzerkonten) und
<strong>shadow</strong> (enth√§lt die verschl√ºsselten Passw√∂rter der
Benutzer bzw. Benutzerinnen)</p></li>
<li><p><strong>/home</strong>:</p>
<p>Enth√§lt Homeverzeichnisse. Das Homeverzeichnis f√ºr den root Benutzer
bzw. Benutzerin ist unter /root zu finden.</p></li>
</ul></li>
<li><p><strong>Webapplikation</strong></p>
<p>Eine statische Webseite, ohne Caching. Ein neu laden der Seite setzt
alle an der Webapplikation vorgenommen √Ñnderungen zur√ºck (geschriebene
Nachrichten werden nicht persistiert).</p>
<p>Beinhaltet eine Dateiupload-Funktion.</p>
<p>Der erste angezeigte Chat beinhaltet ein bereits auf den Server
hochgeladenes Bild.</p></li>
<li><p><strong>Datenbank</strong></p>
<p>Eine MySQL-Datenbank. Enth√§lt Daten √ºber die
Nachrichtenapplikation.</p></li>
</ul>
<h2 id="aufbau-der-√ºbung-1">Aufbau der √úbung</h2>
<p>In dieser √úbung werden Sie verschiedene Perspektiven einnehmen. Die
‚Äúnormalen‚Äù Nutzer/-innen (Einf√ºhrung), die die Webanwendung als
Nachrichtenapplikation nutzen. Die Angreifer/-innen Perspektive
(Webshell-Angriff), die einen Angriff auf den Webserver durchf√ºhren und
schlussendlich die Perspektive eines/r Serveradministrator/-in, welche
die Sicherheitsl√ºcke behebt.</p>
<h2 id="wie-starten-sie-die-√ºbung-1">Wie starten Sie die √úbung?</h2>
<p>In dem Projektordner, welchen Sie heruntergeladen haben, finden Sie
eine <em>STARTER.sh</em> Datei, welche f√ºr Sie den Befehl
<em>docker-compose up -d</em> ausf√ºhrt. Dies startet die
Container-Landschaft, in welcher Sie den Versuch durchf√ºhren werden.
Dies kann etwas Zeit in Anspruch nehmen.</p>
<h3 id="einf√ºhrung-1">Einf√ºhrung</h3>
<p>√ñffnen Sie die Webseite ‚Äúlocalhost:8080‚Äù in einem Browser Ihrer Wahl,
in dem Sie die genannte URL in die Suchleiste eingeben. Machen Sie sich
mit der Webseite und deren Funktionen vertraut.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">üí°</span> Mit Hilfe der Netzwerkanalyse aus den eingebauten Entwicklerwerkzeugen des Browsers k√∂nnen HTTP Anfragen und Antworten der Webseite verfolgt werden.</span></code></pre></div>
<p>üë§ <strong>(Perspektive: Anwender/-in)</strong></p>
<p>Laden Sie vorerst einmal eine normale Bilddatei hoch, in dem Sie
unten links in der Chatleiste auf die B√ºroklammer klicken. Es erscheint
ein grauer Screen. Dr√ºcken Sie erneut auf die B√ºroklammer um ein Bild
auszuw√§hlen. Mit einem Klick auf den Papierflieger l√§sst sich das Bild
hochladen.</p>
